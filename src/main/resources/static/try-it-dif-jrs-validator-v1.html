<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">

<title>Try it - DIF JR/S Validator</title>
<meta content="" name="description">
<meta content="" name="keywords">

<!-- Favicons -->
<link href="assets/img/favicon.png" rel="icon">
<link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

<!-- Google Fonts -->
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
	rel="stylesheet">

<!-- Vendor CSS Files -->
<link href="assets/vendor/bootstrap/css/bootstrap.min.css" 	rel="stylesheet">
<link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" 	rel="stylesheet">
<!--  link href="assets/vendor/aos/aos.css" rel="stylesheet" -->
<link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
<link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
<link href="assets/vendor/glightbox/css/glightbox.min.css" 	rel="stylesheet">
<link rel="stylesheet" href="assets/vendor/font-awesome-4.7.0/css/font-awesome.min.css">

<!-- Template Main CSS File -->
<link href="assets/css/style.css" rel="stylesheet">
<link href="assets/css/jsonview.bundle.css" rel="stylesheet">

<!--  script src="assets/vendor/jquery/jquery-1.6.4.min.js"></script -->
<script src="assets/vendor/jquery/jquery-3.3.1.min.js"></script>
<script src="assets/vendor/jquery/jquery-ui.min.js" integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E=" crossorigin="anonymous"></script>
<!-- =======================================================
  * Template Name: FlexStart - v1.4.0
  * Template URL: https://bootstrapmade.com/flexstart-bootstrap-startup-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
<style>
.sec-text {
	margin-left: 48px;
	margin-right: 48px;
}

th, td, input {
	font: 11px Verdana;
}

.note {
	background-color: #e7f3fe;
	border-left: 6px solid #2196F3;
	font-size: small;
}

.tryit-form {
	margin: 20px;
}

.col-form-label {
	padding-top: 0;
	margin-bottom: 0;
	font-size: inherit;
	line-height: 2;
}

/* The max width is dependant on the container */
.popover{
    max-width: 35%; /* Max Width of the popover (depending on the container!) */
}

.modal-body {
	padding-top: 1rem;
    padding-right: 3rem;
    padding-bottom: 1rem;
    padding-left: 3rem;
}

</style>

<script>

	const api2TableNew = async () => {
		const response = fetch('http://localhost:8080/api/v1/sec-Football/pit?pit=2021-06-29-00.00.00.0', {
		    method: 'GET',
		    headers: {
		      'Content-Type': 'application/json'
		    }
		  });
		  const returnedJson = await response.json(); //extract JSON from the http response
		  createTableFromJson(returnedJson);
		}
	
	var apiCnt=0;
	var mgrInetId = 'x';
	var profInedId = 'x';
	var growthPlatformCd = 'x';
	var growthPlatformNm = 'x';
	var serviceLineCd = 'x';
	var serviceLineNm = 'x';
	var practiceCd = 'x';
	var practiceNm = 'x';
	var serviceAreaCd = 'x';
	var serviceAreaNm = 'x';
	var jobRoleGlobalArray=[];
	var jobRoleCd = 'x';
	var jobRoleNm = 'x';
	var specialtyGlobalArray=[];
	var specialtyCd = 'x';
	var specialtyNm = 'x';
	
	var originalBranch={};
	var leafBranch={};
	
	var helpStructure = [
		{"id":"data-integrity-framework-jrs-validator",
			 "title": "Data Integrity Framework - JR/S Validator Help",
			 "context" : "/help/en/data-integrity-framework-jrs-validator.html"
			} 
		];
	
	class Branch {
		constructor(brandCd, brandNm, growthPlatformCd, growthPlatformNm
				 , serviceLineCd, serviceLineNm, practiceCd, practiceNm, serviceAreaCd, serviceAreaNm
				 , jobRoleCd, jobRoleNm, specialtyCd, specialtyNm, jrsCd, jrsNm
				 , foundInd=0, nodeErrorInd=0, arcErrorInd=0, inetEmailId='', mgrInetId='') {
			this._brandCd = brandCd;
			this._brandNm = brandNm;
			this._growthPlatformCd = growthPlatformCd;
			this._growthPlatformNm = growthPlatformNm;
			this._serviceLineCd = serviceLineCd;
			this._serviceLineNm = serviceLineNm;
			this._practiceCd = practiceCd;
			this._practiceNm = practiceNm;
			this._serviceAreaCd = serviceAreaCd;
			this._serviceAreaNm = serviceAreaNm;
			this._jobRoleCd = jobRoleCd;
			this._jobRoleNm = jobRoleNm;
			this._specialtyCd = specialtyCd;
			this._specialtyNm = specialtyNm;
			this._jrsCd = jrsCd;
			this._jrsNm = jrsNm;
			this._foundInd = foundInd;
			this._nodeErrorInd = nodeErrorInd;
			this._arcErrorInd = arcErrorInd;
			this._inetEmailId = inetEmailId;
			this._mgrInetId = mgrInetId;
		}
		
		getBrandCd() { return this._brandCd; }
		getBrandNm() { return this._brandNm; }
		getGrowthPlatformCd() { return this._growthPlatformCd; }
		getGrowthPlatformNm() { return this._growthPlatformNm; }
		getServiceLineCd() { return this._serviceLineCd; }
		getServiceLineNm() { return this._serviceLineNm; }
		getPracticeCd() { return this._practiceCd; }
		getPracticeNm() { return this._practiceNm; }
		getServiceAreaCd() { return this._serviceAreaCd; }
		getServiceAreaNm() { return this._serviceAreaNm; }
		getJobRoleCd() { return this._jobRoleCd; }
		getJobRoleNm() { return this._jobRoleNm; }
		getSpecialtyCd() { return this._specialtyCd; }
		getSpecialtyNm() { return this._specialtyNm; }
		getJrsCd() { return this._jrsCd; }
		getJrsNm() { return this._jrsNm; }
		getFoundInd() { return this._foundInd; }
		getNodeErrorInd() { return this._nodeErrorInd; }
		getArcErrorInd() { return this._arcErrorInd; }
		getInetEmailId() { return this._inetEmailId; }
		getMgrInetId() { return this._mgrInetId; }
		
		setBrandCd(brandCd) { this._brandCd = brandCd; }
		setBrandNm(brandNm) { this._brandNm = brandNm; }
		setGrowthPlatformCd(growthPlatformCd) { this._growthPlatformCd = growthPlatformCd; }
		setGrowthPlatformNm(growthPlatformNm) { this._growthPlatformNm = growthPlatformNm; }
		setServiceLineCd(serviceLineCd) { this._serviceLineCd = serviceLineCd; }
		setServiceLineNm(serviceLineNm) { this._serviceLineNm = serviceLineNm; }
		setPracticeCd(practiceCd) { this._practiceCd = practiceCd; }
		setPracticeNm(practiceNm) { this._practiceNm = practiceNm; }
		setServiceAreaCd(serviceAreaCd) { this._serviceAreaCd = serviceAreaCd; }
		setServiceAreaNm(serviceAreaNm) { this._serviceAreaNm = serviceAreaNm; }
		setJobRoleCd(jobRoleCd) { this._jobRoleCd = jobRoleCd; }
		setJobRoleNm(jobRoleNm) { this._jobRoleNm = jobRoleNm; }
		setSpecialtyCd(specialtyCd) { this._specialtyCd = specialtyCd; }
		setSpecialtyNm(specialtyNm) { this._specialtyNm = specialtyNm; }
		setJrsCd(jrsCd) { this._jrsCd = jrsCd; }
		setJrsNm(jrsNm) { this._jrsNm = jrsNm; }
		setFoundInd(foundInd) { this._foundInd = foundInd; }
		setNodeErrorInd(nodeErrorInd) { this._nodeErrorInd = nodeErrorInd; }
		setArcErrorInd(arcErrorInd) { this._arcErrorInd = arcErrorInd; }
		setInetEmailId(inetEmailId) { this._inetEmailId = inetEmailId; }
		setMgrInetId(mgrInetId) { this._mgrInetId = mgrInetId; }
	}
	
	//var levels = ["Growth Platform", "Jrs Svc Line", "Jrs Practice", "Jrs Service Area", "Job Role", "Specialty"];
	var levels = [
		{ "name": "Growth Platform", "columnPrefix": "growthPlatform",
			"description": "A Growth Platform is IBM's structure to align to important market trends and ensure our offering creation and go-to-market strategy captures these trends."},
		{ "name": "Service Line", "columnPrefix": "jrsSvcLine",
				"description": "A Service Line is an externally recognizable and established industry market that IBM's customer base would logically know or, in a limited number of cases, are markets that IBM is strategically working to establish in the industry and therefor become recognized offering markets."},
		{ "name": "Practice", "columnPrefix": "jrsPractice",
					"description": "Practice..."},
		{ "name": "Service Area", "columnPrefix": "jrsSvcArea",
					"description": "Service Area..."},
		{ "name": "Job Role", "columnPrefix": "jobRole",
					"description": "Job Role..."},
		{ "name": "Specialty", "columnPrefix": "specialty",
					"description": "Specialty..."}
	];
	
	
	var tree;
	
	//$('#growth-platform-dropdown').change(function () {
	//	growthPlatformTxt = $(this).find("option:selected").text();
	//});
	
	function init() {
			//getTaxonomyFromUrl();
		/*
		 * Listener for information button.  When being shown, it retrieves the title
		 * and content for the information modal based on the key of the information 
		 * button selected.
		 */
		var informationModal = document.getElementById('id-info-modal')
		informationModal.addEventListener('show.bs.modal', function(event) {
			// Button that triggered the modal
			var button = event.relatedTarget
			// Extract info from data-bs-* attributes
			var contentId = button.getAttribute('data-bs-content')
			
			for (help of helpStructure) {
				if (help.id==contentId) break;
			}
			
			var modalTitle = informationModal.querySelector('.modal-title')
			let bodyDiv = document.getElementById('id-info-modal-body')

			modalTitle.textContent = help.title
			bodyDiv.innerHTML = '<div w3-include-html="'+help.context+'"></div>';
			/*make an HTTP request using the attribute value as the file name:*/
			xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
		        if (this.readyState == 4) {
		          if (this.status == 200) {bodyDiv.innerHTML = this.responseText;}
		          if (this.status == 404) {bodyDiv.innerHTML = "Page not found.";}
		        }
			}      
			xhttp.open("GET", window.location.protocol+"//"+window.location.host+help.context, true);
			xhttp.send();
		})
	}
	
	//Get rid of .. temporary
	function populateGlobalVariables(branch) {
		growthPlatformCd = branch.getGrowthPlatformCd() ;
		growthPlatformNm = branch.getGrowthPlatformNm() ;
		serviceLineCd = branch.getServiceLineCd() ;
		serviceLineNm = branch.getServiceLineNm() ;
		practiceCd = branch.getPracticeCd() ;
		practiceNm = branch.getPracticeNm() ;
		serviceAreaCd = branch.getServiceAreaCd() ;
		serviceAreaNm = branch.getServiceAreaNm() ;
		jobRoleCd = branch.getJobRoleCd() ;
		jobRoleNm = branch.getJobRoleNm() ;
		specialtyCd = branch.getSpecialtyCd() ;
		specialtyNm = branch.getSpecialtyNm() ;
		profInedId = branch.getInetEmailId() ;
		mgrInetId = branch.getMgrInetId() ;		
	}
	
	function clearForm() {
		for (i=0; i<levels.length; i++) {
			clearRow(levels[i]);
		}
	}
	
	function clearRow(level) {
		let idified = idify(level.name);
		let row = document.getElementById('id-'+idified);
		row.innerHTML = '';
	}
	
	function clear(key) {
		if (key=='service-area') {
			let keyText = document.getElementById(key+'-text');
			if (keyText!=null) keyText.innerHTML = '';
		}
		else if (key=='job-role' || key=='specialty') {
			let keyText = document.getElementById(key+'-text');
			if (keyText!=null) keyText.innerHTML = '';
			
			let jobRoleTable = document.getElementById(key+'-table');
			if (jobRoleTable!=null) jobRoleTable.innerHTML = '';
		}
		else {
			let  keyDropDown = document.getElementById(key+'-dropdown');
			if (keyDropDown!=null) keyDropDown.length = 0;
		}
	}
	
	function clearKey(key) {
		let element = document.getElementById(key);
		element.innerHTML = '';
	}
	
	function buildEditForm(originalBranch) {
		
		clear('job-role');
		clear('specialty');
		hideMsg();
		enableSaveButton(false);
		
		//Temporary
		populateGlobalVariables(originalBranch);
		
	    buildBranch('current', originalBranch);
	    buildLeafBranch(originalBranch);
	    
	    for (let i = 0; i < levels.length; i++) {
	    	attributeName = '_'+camelCase(levels[i].name);
	    	buildEditRow(i, levels[i], originalBranch[attributeName+"Cd"], originalBranch[attributeName+"Nm"], originalBranch.getNodeErrorInd(), originalBranch.getArcErrorInd());
	    }
	}
	
	function buildEditRow(levelNum, level, code, name, nodeErrorInd, arcErrorInd) {
		let camel = camelCase(level.name);
		let idified = idify(level.name);
		//console.log(level+". "+label.name + ", "+code+", "+name+", "+camel+", "+idified);
		
		if (levelNum<5) nodeLvl = levelNum+1;
		else nodeLvl = levelNum;
		
		let nodeColor = 'red';
		if (isLevelValid(nodeLvl, nodeErrorInd)) nodeColor = 'green';
		
		let arcColor = 'red';
		if (nodeLvl>=5) arcColor = 'white'
		else
			if (isLevelValid(nodeLvl, arcErrorInd)) arcColor = 'green';
		
		
		let row = document.getElementById('id-'+idified);
		row.innerHTML = '';
		
		const editFormGroupRow = document.createElement('div');
		editFormGroupRow.setAttribute('class','form-group row');
		
		const editDiv = document.createElement('div');
		editDiv.setAttribute('class','col-sm-9');
		
		const nodeIcon = document.createElement('i');
		nodeIcon.setAttribute('class','fa fa-cube');
		nodeIcon.setAttribute('title','Node');
		nodeIcon.style.color=nodeColor;
		
		const arcIcon = document.createElement('i');
		arcIcon.setAttribute('class','fa fa-link');
		arcIcon.setAttribute('title','Link');
		arcIcon.style.color=arcColor;
		
		const editLabel = document.createElement('label');
		editLabel.setAttribute('for',idified);
		editLabel.setAttribute('class','col-form-label');
		editLabel.textContent=name + ' ('+code+')';
		
		editDiv.appendChild(nodeIcon);
		let space1TextNode = document.createTextNode(" ");
		editDiv.appendChild(space1TextNode);
		editDiv.appendChild(arcIcon);
		let space2TextNode = document.createTextNode(" ");
		editDiv.appendChild(space2TextNode);
		editDiv.appendChild(editLabel);

		editFormGroupRow.appendChild(editDiv);
		
		const actionBtnDiv = document.createElement('div');
		actionBtnDiv.setAttribute('class','col-sm-3');
		const floatRightDiv = document.createElement('div');
		floatRightDiv.style.float = 'right';
		
		const editActionAchor = document.createElement('a');
		editActionAchor.setAttribute('class','btn btn-default');
		editActionAchor.setAttribute('href','javascript:'+camel+"Edit()");
		editActionAchor.setAttribute('aria-label','Edit '+ level.name);
		
		const editIcon = document.createElement('i');
		editIcon.setAttribute('class','fa fa-pencil fa-fw');

		editIcon.setAttribute('title','Edit '+ level.name);
		editIcon.setAttribute('aria-hidden','true');
		if (level.name=='Service Area' || level.name=='Specialty') {
			editIcon.style.color='#aaa';
			editIcon.style.cursor='default';
		}
		
		editActionAchor.appendChild(editIcon);
		
		var descSpan = document.createElement("span");
		descSpan.setAttribute("class", "d-inline-block");
		descSpan.setAttribute("tabindex", "0");
		descSpan.setAttribute("title", "What is a "+level.name+"?");
		descSpan.setAttribute("data-bs-toggle", "popover");
		descSpan.setAttribute("data-bs-trigger", "hover focus");
		descSpan.setAttribute("data-bs-content", level.description); //xyz
		descSpan.setAttribute("data-bs-level-nm", level.name);
		descSpan.setAttribute("id", "id-"+level.name);
		
		new bootstrap.Popover(descSpan);

		const infoIcon = document.createElement('i');
		infoIcon.setAttribute('class','fa fa-info fa-fw');
		infoIcon.setAttribute('aria-hidden','true');
		descSpan.appendChild(infoIcon);
		
		//if (level.name!='Service Area' && level.name!='Specialty') floatRightDiv.appendChild(editActionAchor);
		floatRightDiv.appendChild(editActionAchor);
		floatRightDiv.appendChild(descSpan);
		
		actionBtnDiv.appendChild(floatRightDiv);
		
		editFormGroupRow.appendChild(actionBtnDiv);
		
		row.appendChild(editFormGroupRow);
	}
	
	function buildSelectRow(level) {
		let levelBaseId = idify(level.name);
		let levelCcNm = camelCase(level.name);
		let row = document.getElementById('id-'+levelBaseId);
		row.innerHTML='';
		
		if (level.name=='Growth Platform' || level.name=="Service Line" || level.name=='Practice') {
			const select = document.createElement('select');
			select.setAttribute('id',levelBaseId+'-dropdown');
			select.setAttribute('name',levelBaseId);
			select.setAttribute('onchange',levelCcNm+'Updated()');
			select.setAttribute('class','form-select');
			row.appendChild(select);
		}
		else if (level.name=='Service Area') {
			const p = document.createElement('p');
			p.setAttribute('id',levelBaseId+'-text');
			row.appendChild(p);
		}
		else if (level.name=='Job Role' || level.name=='Specialty') {
			const p = document.createElement('p');
			p.setAttribute('id',levelBaseId+'-text');
			row.appendChild(p);
		}
	}
	
	function buildBranch(branchId, branch, ogBranch) {
		let row = document.getElementById('nav-'+branchId);
		row.innerHTML="";
		
		const br = document.createElement('br');
		
		const gp = document.createElement('p');
		if ((!(ogBranch === undefined)) && ((branch.getGrowthPlatformNm() != ogBranch.getGrowthPlatformNm()) || (branch.getGrowthPlatformCd() != ogBranch.getGrowthPlatformCd())))
			gp.style.color='red';
		gp.innerHTML = "<b>GP:</b> "+branch.getGrowthPlatformNm()+" (" + branch.getGrowthPlatformCd() + ")";
		
		const sl = document.createElement('p');
		if ((!(ogBranch === undefined)) && ((branch.getServiceLineNm() != ogBranch.getServiceLineNm()) || (branch.getServiceLineCd() != ogBranch.getServiceLineCd())))
			sl.style.color='red';
		sl.innerHTML = "<b>SL:</b> "+branch.getServiceLineNm()+" (" + branch.getServiceLineCd() + ")";
		
		const p = document.createElement('p');
		if ((!(ogBranch === undefined)) && ((branch.getPracticeNm() != ogBranch.getPracticeNm()) || (branch.getPracticeCd() != ogBranch.getPracticeCd())))
			p.style.color='red';
		p.innerHTML = "<b>P :</b> "+branch.getPracticeNm()+" (" + branch.getPracticeCd() + ")";
		
		const sa = document.createElement('p');
		sa.innerHTML = "<b>SA:</b> "+branch.getServiceAreaNm()+" (" + branch.getServiceAreaCd() + ")";
		
		const jr = document.createElement('p');
		jr.innerHTML = "<b>JR:</b> "+branch.getJobRoleNm()+" (" + branch.getJobRoleCd() + ")";
		
		const s = document.createElement('p');
		s.innerHTML = "<b>S :</b> "+branch.getSpecialtyNm()+" (" + branch.getSpecialtyCd() + ")";
		
		row.appendChild(br);
		row.appendChild(gp);
		row.appendChild(sl);
		row.appendChild(p);
		row.appendChild(sa);
		row.appendChild(jr);
		row.appendChild(s);

		const div = document.createElement('div');
		const btn = document.createElement('button');
		btn.setAttribute('class','btn btn-primary btn-sm');
		btn.setAttribute('onclick','javascript:acceptJrs()');
		btn.innerHTML = 'Accept JR/S';
		div.appendChild(btn);
		row.appendChild(div);
	}
	
	function buildLeafBranch(currentBranch) {
		let row = document.getElementById('nav-leaf');
		row.innerHTML="";
		
		if (currentBranch.getFoundInd()==1) {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/jrss/'+currentBranch.getJrsCd()+"?includeParentage=true";
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
			    const respJson = JSON.parse(request.responseText);
			    const data = respJson[0];
			    
			    leafBranch = new Branch(data['brandCd'],
			    		data['brandNm'],
			    		data.children[0]['growthPlatformCd'],
			    		data.children[0]['growthPlatformNm'],
			    		data.children[0].children[0]['code'],
			    		data.children[0].children[0]['description'],
			    		data.children[0].children[0].children[0]['code'],
			    		data.children[0].children[0].children[0]['description'],
			    		data.children[0].children[0].children[0].children[0]['code'],
			    		data.children[0].children[0].children[0].children[0]['description'],
			    		currentBranch.getJobRoleCd(),
			    		currentBranch.getJobRoleNm(),
			    		currentBranch.getSpecialtyCd(),
			    		currentBranch.getSpecialtyNm(),
			    		data.children[0].children[0].children[0].children[0].children[0]['jrsCd'],
			    		data.children[0].children[0].children[0].children[0].children[0]['jrsNm'],
			    		0,
			    		0,
			    		0,
			    		currentBranch.getInetEmailId(),
			    		currentBranch.getMgrInetId());
			    	buildBranch('leaf', leafBranch, currentBranch);
			    
			   } else {
			    	// Reached the server, but it returned an error
					row.innerHTML="An error occured ${request.status} - ${request.statusText}";
					console.error('An error occured ${request.status} - ${request.statusText}');
			  }   
			}

			request.onerror = function() {
				row.innerHTML='An error occurred fetching the JSON from ' + url;
				console.error('An error occurred fetching the JSON from ' + url);
			};
			request.send();
		}
		else {			
			const br = document.createElement('br');
			const p = document.createElement('p');
			p.innerHTML = "<b>Leaf node not found for JR/S "+currentBranch.getJrsNm()+" ("+currentBranch.getJrsCd()+").</b>";
			
			row.appendChild(br);
			row.appendChild(p);			
		}
	}
	
	function wfmProfessionalUpdated() {
		let  wfmProfDd = document.getElementById('wfm-professional-dropdown');
		mgrInetId = wfmProfDd.value;
		
		clearForm();
		clear('professional');
		clearKey('nav-current');
		clearKey('nav-leaf');
		
		clear('job-role');
		clear('specialty');
		hideMsg();
		enableSaveButton(false);
		
		originalBranch={};
		leafBranch={};
		
		if (mgrInetId != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/dif-evaluation/jrs-evaluation-errors/mgr-inet-ids/'+mgrInetId+'/professionals';
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
				let  professionalDd = document.getElementById('professional-dropdown');
				professionalDd.innerHTML='';
			    const respJson = JSON.parse(request.responseText);
			    const data = respJson;
			    let option;
			    option = document.createElement('option');
			    option.text = 'Choose a professional';
			    option.value = 'x';
			    professionalDd.add(option);
			    for (let i = 0; i < data.length; i++) {
			      option = document.createElement('option');
			      option.text = data[i].inetEmailId;
			      option.value = data[i].inetEmailId;
			      professionalDd.add(option);
			    }
			   } else {
			    	// Reached the server, but it returned an error
				   console.error('An error occured ${request.status} - ${request.statusText}');
				   alert(request.status + " - " +request.statusText + '.\nProfessionals failed to be retrieved for WFM Professional/Manager '+mgrInetId+'.');
			  }   
			}

			request.onerror = function() {
			  console.error('An error occurred fetching the JSON from ' + url);
			  alert('An error occurred fetching the JSON from ' + url);
			};
			request.send();
		}
	}
	
	function professionalUpdated() {
		clearForm();
		clearKey('nav-current');
		clearKey('nav-leaf');
		
		clear('job-role');
		clear('specialty');
		hideMsg();
		enableSaveButton(false);
		let  profDd = document.getElementById('professional-dropdown');
		profInedId = profDd.value;
		
		if (profInedId != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/dif-evaluation/jrs-evaluation-errors/'+profInedId;
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
			    const respJson = JSON.parse(request.responseText);
			    const data = respJson[0];
			    
			    originalBranch = new Branch(data['brandCd'],
			    		data['brandNm'],
			    		data['growthPlatformCd'],
			    		data['growthPlatformNm'],
			    		data['jrsSvcLineCd'],
			    		data['jrsSvcLineNm'],
			    		data['jrsPracticeCd'],
			    		data['jrsPracticeNm'],
			    		data['jrsSvcAreaCd'],
			    		data['jrsSvcAreaNm'],
			    		data['jobRoleCd'],
			    		data['jobRoleNm'],
			    		data['specialtyCd'],
			    		data['specialtyNm'],
			    		data['jrsCd'],
			    		data['jrsNm'],
			    		data['foundInd'],
			    		data['nodeErrorInd'],
			    		data['arcErrorInd'],
			    		data['inetEmailId'],
			    		data['mgrInetId']);

					buildEditForm(originalBranch);
			   } else {
			    	// Reached the server, but it returned an error
				   console.error('An error occured ${request.status} - ${request.statusText}');
				   alert(request.status + " - " +request.statusText + '.\nProfessional details failed to be retrieved for '+profInetId+'.');
			  }   
			}

			request.onerror = function() {
			  console.error('An error occurred fetching the JSON from ' + url);
			 alert('An error occurred fetching the JSON from ' + url);
			};
			request.send();
		}
	}	
	
	function growthPlatformEdit() {
		
		buildSelectRow(levels[0]);
		buildSelectRow(levels[1]);
		buildSelectRow(levels[2]);
		buildSelectRow(levels[3]);
		buildSelectRow(levels[4]);
		buildSelectRow(levels[5]);
		growthPlatformPopulate();
		
	}
	
	function serviceLineEdit() {
		if (!(isLevelValid(1,originalBranch.getNodeErrorInd())
				//&& isLevelValid(1,originalBranch.getArcErrorInd())
				)) {
			alert("The growth platform node or arc of the current Service Line ("+originalBranch.getServiceLineNm()+") is invalid. You must start editing at the invalid level.");
			return;			
		}
		console.log("originalBranch.getServiceLineCd()="+originalBranch.getServiceLineCd());
		buildSelectRow(levels[1]);
		buildSelectRow(levels[2]);
		buildSelectRow(levels[3]);
		buildSelectRow(levels[4]);
		buildSelectRow(levels[5]);
		
		serviceLinePopulate(originalBranch.getGrowthPlatformCd(),originalBranch.getGrowthPlatformNm());
	}
	
	function practiceEdit() {
		if (!(isLevelValid(1,originalBranch.getNodeErrorInd()) && isLevelValid(2,originalBranch.getNodeErrorInd())
				&& isLevelValid(1,originalBranch.getArcErrorInd()) 
				//&& isLevelValid(2,originalBranch.getArcErrorInd())
				)) {
			alert("A parent node or arc of the current Practice ("+originalBranch.getPracticeNm()+") is invalid. You must start editing at the invalid level.");
			return;			
		}
		console.log("originalBranch.getPracticeCd()="+originalBranch.getPracticeCd());
		
		buildSelectRow(levels[2]);
		buildSelectRow(levels[3]);
		buildSelectRow(levels[4]);
		buildSelectRow(levels[5]);
		
		practicePopulate(originalBranch.getServiceLineCd(),originalBranch.getServiceLineNm());
	}
	
	function jobRoleEdit() {
		if (!(isLevelValid(1,originalBranch.getNodeErrorInd()) && isLevelValid(2,originalBranch.getNodeErrorInd()) && isLevelValid(3,originalBranch.getNodeErrorInd())
				&& isLevelValid(1,originalBranch.getArcErrorInd()) 
				&& isLevelValid(2,originalBranch.getArcErrorInd())
				)) {
			alert("A parent node or arc of the current Job Role ("+originalBranch.getJobRoleNm()+") is invalid. You must start editing at the invalid level.");
			return;			
		}

		buildSelectRow(levels[3]);
		buildSelectRow(levels[4]);
		buildSelectRow(levels[5]);
		
		jobRolePopulate(originalBranch.getPracticeCd(),originalBranch.getPracticeNm());
		
	}
	
	function serviceAreaEdit() {}
	
	function specialtyEdit() {}
	
	function growthPlatformPopulate() {
		clear('growth-platform');
		clear('service-line');
		clear('practice');
		clear('service-area');
		clear('job-role');
		clear('specialty');
		hideMsg();
		
		const url = window.location.protocol+"//"+window.location.host+"/api/v1/eds-ut-jrs-tax/brands/10J00/growth-platforms"
		+ "?filters=GROWTH_PLATFORM_NM%20NOT%20LIKE%20'*(AUO)*'";
	
		addToList('id_api_list',url);

		const request = new XMLHttpRequest();
		request.open('GET', url, true);

		request.onload = function() {
		  if (request.status === 200) {
			let  growthPlatformDd = document.getElementById('growth-platform-dropdown');
		    const data = JSON.parse(request.responseText);
		    let option;
		    option = document.createElement('option');
		    option.text = 'Choose a growth platform';
		    option.value = 'x';
		    growthPlatformDd.add(option);
		    for (let i = 0; i < data.length; i++) {
		      option = document.createElement('option');
		      option.text = data[i].growthPlatformNm + " ("+data[i].growthPlatformCd+")";
		      option.value = data[i].growthPlatformCd;
		      growthPlatformDd.add(option);
		    }
		    
			getTaxonomyFromUrl();
			
		   } else {
		    	// Reached the server, but it returned an error
			   console.error('An error occured ${request.status} - ${request.statusText}');
			   alert(request.status + " - " +request.statusText + ".\nGrowth Platform retrieval failed for Brand 10J00.");
		  }   
		}

		request.onerror = function() {
		  console.error('An error occurred fetching the JSON from ' + url);
		  alert('An error occurred fetching the JSON from ' + url+'.');
		};

		request.send();
	}
	
	function growthPlatformUpdated() {
		let  growthPlatformDd = document.getElementById('growth-platform-dropdown');
		growthPlatformCd = growthPlatformDd.value;
		growthPlatformNm = $('#growth-platform-dropdown').find("option:selected").text();
		serviceLinePopulate(growthPlatformCd, growthPlatformNm);
	}
	
	function serviceLinePopulate(growthPlatformCd, growthPlatformNm) {
		clear('service-line');
		clear('practice');
		clear('service-area');
		clear('job-role');
		clear('specialty');
		hideMsg();
		
		if (growthPlatformCd != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/brands/10J00/growth-platforms/'+growthPlatformCd+'/service-lines'
			+"?filters=SERVICE_LINE_NM%20NOT%20LIKE%20'*(AUO)*'";
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
				let  serviceLineDd = document.getElementById('service-line-dropdown');
			    const respJson = JSON.parse(request.responseText);
			    const data = respJson[0].children[0].children;
			    let option;
			    option = document.createElement('option');
			    option.text = 'Choose a service line';
			    option.value = 'x';
			    serviceLineDd.add(option);
			    for (let i = 0; i < data.length; i++) {
			      option = document.createElement('option');
			      option.text = data[i].serviceLineNm + " ("+data[i].serviceLineCd+")";
			      option.value = data[i].serviceLineCd;
			      serviceLineDd.add(option);
			    }
			   } else {
			    	// Reached the server, but it returned an error
				   console.error('An error occured ${request.status} - ${request.statusText}');
				   alert(request.status + " - " +request.statusText + ".\nNo Service Lines exist for Growth Platform "+growthPlatformCd+".")
			  }   
			}

			request.onerror = function() {
			  console.error('An error occurred fetching the JSON from ' + url);
			  alert('An error occurred fetching the JSON from ' + url+'.');
			};

			request.send();
		}
	}
	
	function serviceLineUpdated() {
		let  serviceLineDd = document.getElementById('service-line-dropdown');
		serviceLineCd = serviceLineDd.value;
		serviceLineNm = $('#service-line-dropdown').find("option:selected").text();
		practicePopulate(serviceLineCd, serviceLineNm);
	}
		
	function practicePopulate(serviceLineCd, serviceLineNm) {	
		
		clear('practice');
		clear('service-area');
		clear('job-role');
		clear('specialty');
		hideMsg();
		
		if (growthPlatformCd != 'x' && serviceLineCd != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/brands/10J00/growth-platforms/'+growthPlatformCd+'/service-lines/'+serviceLineCd+'/practices';
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
				let  practiceDd = document.getElementById('practice-dropdown');
			    const respJson = JSON.parse(request.responseText);
			    const data = respJson[0].children[0].children[0].children;
			    let option;
			    option = document.createElement('option');
			    option.text = 'Choose a practice';
			    option.value = 'x';
			    practiceDd.add(option);
			    for (let i = 0; i < data.length; i++) {
			      option = document.createElement('option');
			      option.text = data[i].practiceNm+" ("+data[i].practiceCd+")";
			      option.value = data[i].practiceCd;
			      practiceDd.add(option);
			    }
			   } else {
			    	// Reached the server, but it returned an error
					console.error('An error occured ${request.status} - ${request.statusText}');
			    	alert(request.status + " - " +request.statusText + ".\nNo practices exist for Growth Platform "+growthPlatformCd+" and Service Line "+serviceLineCd+".")
			  }   
			}

			request.onerror = function() {
				console.error('An error occurred fetching the JSON from ' + url);
				alert('An error occurred fetching the JSON from ' + url+'.');
			};

			request.send();
		}
	}	
	
	function practiceUpdated() {
		let  practiceDd = document.getElementById('practice-dropdown');
		practiceCd = practiceDd.value;
		practiceNm = $('#practice-dropdown').find("option:selected").text();
		jobRolePopulate(practiceCd, practiceNm);
	}
	
	function jobRolePopulate(practiceCd, practiceNm) {
		
		clear('service-area');
		clear('job-role');
		clear('specialty');
		hideMsg();
		
		if (practiceCd != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/practices/'+practiceCd+'/job-roles';
			
			addToList('id_api_list',url);
			
			api2JobRoleTable(url);
		}
	}
	
	function jobRoleUpdated(index) {
		
		clear('specialty');
		hideMsg();
		
		jobRoleCd = jobRoleGlobalArray[index].jobRoleCd;
		jobRoleNm = jobRoleGlobalArray[index].jobRoleNm;
		
		let jobRoleTxt = document.getElementById('job-role-text');
		jobRoleTxt.innerHTML = jobRoleGlobalArray[index].jobRoleCd + " - "+jobRoleGlobalArray[index].jobRoleNm;
		
		if (jobRoleCd != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/practices/'+practiceCd+'/job-roles/'+jobRoleCd+'/specialties';
			
			addToList('id_api_list',url);
			
			api2SpecialtiesTable(url);
		}
		
	}
	
	function specialtyUpdated(index) {
		
		specialtyCd = specialtyGlobalArray[index].specialtyCd;
		specialtyNm = specialtyGlobalArray[index].specialtyNm;
		
		let specialtyTxt = document.getElementById('specialty-text');
		specialtyTxt.innerHTML = specialtyGlobalArray[index].specialtyCd + " - "+specialtyGlobalArray[index].specialtyNm;
		
		if (specialtyCd != 'x') {
			const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/jrss/'+jobRoleCd+'-'+specialtyCd+'/?includeParentage=true';
			
			addToList('id_api_list',url);

			const request = new XMLHttpRequest();
			request.open('GET', url, true);

			request.onload = function() {
			  if (request.status === 200) {
				let  serviceAreaTxt = document.getElementById('service-area-text');
				const respJson = JSON.parse(request.responseText);
			    const data = respJson[0].children[0].children[0].children[0].children[0];
			    serviceAreaTxt.innerHTML = data.serviceAreaCd + " - " + data.serviceAreaNm;
			    serviceAreaCd = data.serviceAreaCd;
			    serviceAreaNm = data.serviceAreaNm;
			    
				let uiMsg = document.getElementById("msg")
				let msgLine = document.getElementById("msg-line")
				uiMsg.innerHTML = ""
				msgLine.classList.remove('show'); 
			    let msg = "<h5>Job Role Specialty</h5>"
			         +"<ul><li><b>Brand: </b> 10J00 - IBM Consulting</li>"
			         + "<li><b>Growth Platform: </b> "+growthPlatformCd + " - " + growthPlatformNm + "</li>"
			         + "<li><b>Service Line: </b> "+serviceLineCd + " - " + serviceLineNm + "</li>"
			         + "<li><b>Practice: </b> "+practiceCd + " - " + practiceNm + "</li>"
			         + "<li><b>Service Area: </b> "+serviceAreaCd + " - " + serviceAreaNm + "</li>"
			         + "<li><b>Job Role: </b> "+jobRoleCd + " - " + jobRoleNm + "</li>"
			         + "<li><b>Specialty: </b> "+specialtyCd + " - " + specialtyNm + "</li>"
			         + "</ul>";
			    uiMsg.innerHTML=msg;
			    msgLine.classList.remove('alert-warning');
				msgLine.classList.remove('alert-success'); 
				msgLine.classList.remove('alert-danger'); 
				msgLine.classList.remove('show');
				msgLine.classList.add('alert-success'); 
				msgLine.classList.add('show');
				
				enableSaveButton(true);
				

			   } else {
			    	// Reached the server, but it returned an error
				   console.error('An error occured ${request.status} - ${request.statusText}');
				   alert(request.status + ' - ' +request.statusText + '.\nJob Role/Specialty not found for '+jobRoleCd+'-'+specialtyCd+'.');
			  }   
			}

			request.onerror = function() {
			  console.error('An error occurred fetching the JSON from ' + url);
			  alert('An error occurred fetching the JSON from ' + url);
			};

			request.send();
		}
		
	}
	
	function api2JobRoleTable(url) {
		
	    var req = new XMLHttpRequest();
	    req.onreadystatechange = function() {
	         if (this.readyState == 4 && this.status == 200) {
	        	 createJobRoleTableFromJson(this.response);
	         }
	    };
	    req.open("GET", url, true);
	    req.setRequestHeader("Content-type", "application/json");
	    req.responseType = 'json';
	    req.send(null);
	}
	
	function api2SpecialtiesTable(url) {
		
	    var req = new XMLHttpRequest();
	    req.onreadystatechange = function() {
	         if (this.readyState == 4 && this.status == 200) {
	        	 createSpecialtyTableFromJson(this.response);
	         }
	    };
	    req.open("GET", url, true);
	    req.setRequestHeader("Content-type", "application/json");
	    req.responseType = 'json';
	    req.send(null);
	}

	function createJobRoleTableFromJson(jobRoles) {

		// EXTRACT VALUE FOR HTML HEADER. 

		var colTemp = ['Select', 'Job Role Code', 'Job Role', 'Compensation Grade List', 'Description'];

		// CREATE DYNAMIC TABLE.
		var table = document.createElement("table");
		table.setAttribute("class","table table-hover table-sm table-striped");

		// CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.
		
		var thead = document.createElement("thead");

		var tr = document.createElement("tr");

		for (var i = 0; i < colTemp.length; i++) {
			var th = document.createElement("th"); // TABLE HEADER.
			th.innerHTML = colTemp[i];
			tr.appendChild(th);
		}
		thead.appendChild(tr);
		table.appendChild(thead);

		var tbody = document.createElement("tbody");
		
		//jobRoles = myJson[0].children;
		jobRoleGlobalArray = jobRoles;
		
		for (var i=0; i<jobRoles.length; i++) {
			//let jobRoleCd = jobRoles[i].jobRoleCd;
			tr = tbody.insertRow(-1);
			
			var x = document.createElement("input");
			x.setAttribute("value", i);
			x.setAttribute("id", 'job-role-'+i);
			x.setAttribute("name", 'job-role');
			x.setAttribute("type", 'radio');
			x.setAttribute("onclick", 'jobRoleUpdated(this.value)');

			var tabCell = tr.insertCell(-1);
			tabCell.appendChild(x);
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = jobRoles[i].jobRoleCd;
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = jobRoles[i].jobRoleNm;
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = jobRoles[i].cmpnstnGrdLst;
			
			tabCell = tr.insertCell(-1);
			var descSpan = document.createElement("span");
			descSpan.setAttribute("class", "d-inline-block");
			descSpan.setAttribute("tabindex", "0");
			descSpan.setAttribute("title", jobRoles[i].jobRoleCd + " : "+jobRoles[i].jobRoleNm);
			descSpan.setAttribute("data-bs-toggle", "popover");
			descSpan.setAttribute("data-bs-trigger", "hover focus");
			descSpan.setAttribute("data-bs-content", "Loading...");
			descSpan.setAttribute("data-bs-job-role-cd", jobRoles[i].jobRoleCd);
			descSpan.setAttribute("id", "id-"+jobRoles[i].jobRoleCd);
			
			new bootstrap.Popover(descSpan);
			
			descSpan.addEventListener('shown.bs.popover', function () {
				let jobRoleCd = $(this).attr('data-bs-job-role-cd');
				
				let dataBsContent = $(this).attr('data-bs-content');
				
				if (dataBsContent=='Loading...') {				
					const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/job-role-descriptions/'+jobRoleCd;
					
					addToList('id_api_list',url);
	
					const request = new XMLHttpRequest();
					request.open('GET', url, true);
	
					request.onload = function() {
					  if (request.status === 200) {
						  const respJson = JSON.parse(request.responseText);
						  
						  let popupEl = document.getElementById("id-"+respJson[0].jobRoleCd);
						  popupEl.setAttribute('data-bs-content',respJson[0].jobRoleDesc);
						  
						  var popover = bootstrap.Popover.getInstance(popupEl);

    					  // change the content
						  popover._config.content = respJson[0].jobRoleDesc;
						  popover.setContent();
					  }
					  else {
						  $(this).attr('data-bs-content','Could not retrieve job role description.');
					  }
					}
					
					request.onerror = function() {
						console.error('An error occurred fetching the JSON from ' + url);
						$(this).attr('data-bs-content','Could not retrieve job role description.');
					};
	
					request.send();
				}
				
			})
			
			const descIcon = document.createElement('i');
			descIcon.setAttribute('class','fa fa-commenting fa-lg');		
			descSpan.appendChild(descIcon);
			
			tabCell.appendChild(descSpan);
		}
		
		table.appendChild(tbody);

		// FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
		var jobRoleContainer = document.getElementById("job-role-table");
		jobRoleContainer.innerHTML = "";
		jobRoleContainer.appendChild(table);
	}
	
	function createSpecialtyTableFromJson(specialties) {

		// EXTRACT VALUE FOR HTML HEADER. 

		var colTemp = ['Select', 'Specialty Code', 'Specialty', 'Compensation Grade List','Description'];

		// CREATE DYNAMIC TABLE.
		var table = document.createElement("table");
		table.setAttribute("class","table table-hover table-sm table-striped");

		// CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.
		
		var thead = document.createElement("thead");

		var tr = document.createElement("tr");

		for (var i = 0; i < colTemp.length; i++) {
			var th = document.createElement("th"); // TABLE HEADER.
			th.innerHTML = colTemp[i];
			tr.appendChild(th);
		}
		thead.appendChild(tr);
		table.appendChild(thead);

		var tbody = document.createElement("tbody");
		
		specialtyGlobalArray = specialties;
		
		for (var i=0; i<specialties.length; i++) {
			tr = tbody.insertRow(-1);
			
			var x = document.createElement("input");
			x.setAttribute("value", i);
			x.setAttribute("id", 'specialty-'+i);
			x.setAttribute("name", 'specialty');
			x.setAttribute("type", 'radio');
			x.setAttribute("onclick", 'specialtyUpdated(this.value)');

			var tabCell = tr.insertCell(-1);
			tabCell.appendChild(x);
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = specialties[i].specialtyCd;
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = specialties[i].specialtyNm;
			
			tabCell = tr.insertCell(-1);
			tabCell.innerHTML = specialties[i].cmpnstnGrdLst;
			
			tabCell = tr.insertCell(-1);
			var descSpan = document.createElement("span");
			descSpan.setAttribute("class", "d-inline-block");
			descSpan.setAttribute("tabindex", "0");
			descSpan.setAttribute("title", jobRoleCd+"-"+specialties[i].specialtyCd + " : "+jobRoleNm+"-"+specialties[i].specialtyNm);
			descSpan.setAttribute("data-bs-toggle", "popover");
			descSpan.setAttribute("data-bs-trigger", "hover focus");
			descSpan.setAttribute("data-bs-content", "Loading...");
			descSpan.setAttribute("data-bs-jrs-cd", jobRoleCd+"-"+specialties[i].specialtyCd);
			descSpan.setAttribute("id", "id-"+jobRoleCd+"-"+specialties[i].specialtyCd);
			
			new bootstrap.Popover(descSpan);
			
			descSpan.addEventListener('shown.bs.popover', function () {
				let jrsCd = $(this).attr('data-bs-jrs-cd');
				
				let dataBsContent = $(this).attr('data-bs-content');
				
				if (dataBsContent=='Loading...') {				
					const url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/jrs-descriptions/'+jrsCd;
					
					addToList('id_api_list',url);
	
					const request = new XMLHttpRequest();
					request.open('GET', url, true);
	
					request.onload = function() {
					  if (request.status === 200) {
						  const respJson = JSON.parse(request.responseText);
						  
						  let popupEl = document.getElementById("id-"+respJson[0].jrsCd);
						  popupEl.setAttribute('data-bs-content',respJson[0].jrsDesc);
						  
						  var popover = bootstrap.Popover.getInstance(popupEl);

    					  // change the content
						  popover._config.content = respJson[0].jrsDesc;
						  popover.setContent();
					  }
					  else {
						  $(this).attr('data-bs-content','Could not retrieve job role description.');
					  }
					}
					
					request.onerror = function() {
						console.error('An error occurred fetching the JSON from ' + url);
						$(this).attr('data-bs-content','Could not retrieve job role description.');
					};
	
					request.send();
				}
				
			})
			
			const descIcon = document.createElement('i');
			descIcon.setAttribute('class','fa fa-commenting fa-lg');		
			descSpan.appendChild(descIcon);
			
			tabCell.appendChild(descSpan);			
		}
		
		table.appendChild(tbody);

		// FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
		var specialtyContainer = document.getElementById("specialty-table");
		specialtyContainer.innerHTML = "";
		specialtyContainer.appendChild(table);
	}	
	
	function addToList(root, item) {
		var ul = document.getElementById(root);
		var li = document.createElement('li');
		li.setAttribute("class","list-group-item");

	    var a = document.createElement('a');
	    a.target = '_blank';
	    a.href = item;
	    a.innerText = item;
	    li.appendChild(document.createTextNode(String(++apiCnt)+". "));
	    li.appendChild(a);
		
		ul.appendChild(li);
	}
	
	function getTaxonomyFromUrl() {

		let url = window.location.protocol+"//"+window.location.host+'/api/v1/eds-ut-jrs-tax/jrss?includeParentage=true';
		addToList('id_api_list',url);
		
		let headers = new Headers();
		headers.append('Content-Type', 'application/json');
		headers.append('Accept', 'application/json');
		headers.append('Access-Control-Allow-Origin', 'http://localhost:8080');
		headers.append('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')
		headers.append('Access-Control-Allow-Headers', 'Origin, Content-Type, Accept');

		fetch(url) //, { headers: headers })
			.then((res)=> {
				return res.text();
			})
			.then((data) => {
				skinnyJson = buildJrsTree(data);
				//console.log(skinnyJson);
				tree = JsonView.createTree(skinnyJson); //(data)
				rootElement = document.getElementById('root');
				rootElement.innerHTML="";
				JsonView.render(tree, rootElement);
			})
			.catch((err) => {
				console.log(err);
		})
	}
	
	function buildJrsTree(data) {
		const json = JSON.parse(data);
		growthPlatforms = json[0].children;
		
		let brand = {"code":"10J00","description": "IBM Consulting", "growthPlatforms":[]};
		let brands = [];
		brands.push(brand);
		
		for (i=0;i<growthPlatforms.length;i++) {
			let growthPlatform = {};
			growthPlatform["code"] = growthPlatforms[i].growthPlatformCd;
			growthPlatform["description"] = growthPlatforms[i].growthPlatformNm;
			growthPlatform["serviceLines"] = [];
			
			serviceLines = growthPlatforms[i].children;
			for (j=0;j<serviceLines.length;j++) {
				let serviceLine = {};
				serviceLine["code"] = serviceLines[j].serviceLineCd;
				serviceLine["description"] = serviceLines[j].serviceLineNm;
				serviceLine["practices"] = [];
				
				practices = serviceLines[j].children;
				for (p=0;p<practices.length;p++) {
					let practice = {};
					practice["code"] = practices[p].practiceCd;
					practice["description"] = practices[p].practiceNm;
					practice["serviceAreas"] = [];
					
					serviceAreas = practices[p].children;
					for (k=0;k<serviceAreas.length;k++) {
						let serviceArea = {};
						serviceArea["code"] = serviceAreas[k].serviceAreaCd;
						serviceArea["description"] = serviceAreas[k].serviceAreaNm;
						serviceArea["jrss"] = [];
						
						jrss = serviceAreas[k].children;
						for (l=0;l<jrss.length;l++) {
							let jrs = {};
							jrs["code"] = jrss[l].jrsCd;
							jrs["description"] = jrss[l].jrsNm;
							
							serviceArea.jrss.push(jrs);
						}
						practice.serviceAreas.push(serviceArea);
					}
					serviceLine.practices.push(practice);
				}
				growthPlatform.serviceLines.push(serviceLine);
			}
			brand.growthPlatforms.push(growthPlatform)
		}
		
		return JSON.stringify(brands);
	}
	
	function hideMsg() {
		let uiMsg = document.getElementById("msg")
		let msgLine = document.getElementById("msg-line")
		uiMsg.innerHTML = ""
		msgLine.classList.remove('show'); 
	}
	
	function camelCase(str) {
		return str.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g, function(match, index) {
			if (+match === 0) return ""; // or if (/\s+/.test(match)) for white spaces
			return index === 0 ? match.toLowerCase() : match.toUpperCase();
		});
	}
	
	function idify(str) {
		return str.replaceAll(' ', '-').toLowerCase();
	}
	
	function isLevelValid(level, status) {
		levelValue = 2**level;
	    if ((status & levelValue) == levelValue) return false;
	    else return true;
	}
	
	function isEmpty(obj) {
	    return Object.keys(obj).length === 0;
	}
	
	function doCancel() {
		if (!(isEmpty(originalBranch)))
			buildEditForm(originalBranch);
	}
	
	function doSave() {
		alert('RESTful POST '+ window.location.protocol+"//"+window.location.host+'/api/v1/dif-evaluation/jrs-evaluation-errors.\n\rThis will insert the updated/new taxonomy branch information into a JR/S validation table. This table has been implemented as a slow changing dimension so that all versions/states are persisted.\n\rThe updated/new taxonomy branch information is passed to the POST method as a JSON structure in the body of the POST request.');
	}
	
	function enableSaveButton(value) {
		$('#id-btn-save').prop('disabled', !value);
	};
	
	function acceptJrs() {
		alert('TO-DO: Initiate the edit panel with the leafBranch (JR/S) object, setting node and arc error indicator to 0.');
	}
	
	function acceptRecommendation() {
		alert('TO-DO: Initiate the edit panel with the recommendedBranch (to be created) object, setting node and arc error indicator to 0.');
	}
	  
	
</script>
</head>

<body onload="javascript:init()">

<!-- could use modal-fullscreen or modal-xl -->
<div class="modal fade" id="id-info-modal" tabindex="-1" aria-labelledby="id-info-modalLabel" aria-hidden="true">
	<div class="modal-dialog  modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="id-info-modal-title">New message</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body" id="id-info-modal-body"></div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<!-- Modal -->
<div class="modal fade jrs-modal-wide" id="jrsViewerModal" tabindex="-1" role="dialog" aria-labelledby="jrsViewerModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="jrsViewerLabel">Full JR/S taxonomy viewer</h5>
				<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="panel-body">
					<div>
						<button type="button" class="btn btn-primary btn-sm" onclick="javascript:JsonView.expandChildren(tree)">Expand all</button>
						<button type="button" class="btn btn-primary btn-sm" onclick="javascript:JsonView.collapseChildren(tree)">Collapse all</button>
					</div>
					<div class="mt-2"></div>
					<div id="root">
						<div class="spinner-border text-primary" role="status">
							<span class="visually-hidden">Loading...</span>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<!-- ======= Header  ======= -->
  <header id="header" class="header fixed-top">
    <div
		class="container-fluid container-xl d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center">
        <img src="assets/img/logo.png" alt="">
        <span>WFM</span>
      </a>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto " href="..">Home</a></li>
          <li><a class="nav-link scrollto" href="..#about">About</a></li>
          <li><a class="nav-link scrollto" href="..#try-it">Try-it</a></li>
          <li><a class="nav-link scrollto" href="..#team">Team</a></li>
          <li><a class="getstarted scrollto" href="swagger-ui.html">Get Started</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav>
		<!-- .navbar -->

    </div>
  </header>
<!-- End Header -->

  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section class="breadcrumbs">
      <div class="container">

        <ol>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../index.html#try-it">Try-it</a></li>
          <li>DIF JR/S Validator</li>
        </ol>
        <h2>Data Integrity Framework - JR/S Validator</h2>

      </div>
    </section>
	<!-- End Breadcrumbs -->

    <!-- ======= Portfolio Details Section ======= -->
    <section id="portfolio-details" class="portfolio-details">
      <div class="container">

        <div class="row gy-4">

          <div class="col-lg-8">

			<div class="container">

				<div class="ss-form">
					<!-- form action="javascript:jrsLookup()"-->
					<form>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="growth-platform" class="col-sm-3 col-form-label"><b>Managers</b></label>
							<div class="col-sm-9" id="id-wfm-professionals">
								<select id="wfm-professional-dropdown" name="wfm-professional"
											onchange="wfmProfessionalUpdated()" class="form-select">
									<option value="x" selected>Select manager intranet id</option>
									<option value="manager01@ibm.com">manager01@ibm.com</option>
									<option value="manager02@ibm.com">manager02@ibm.com</option>
									<option value="manager03@ibm.com">manager03@ibm.com</option>
									<option value="manager04@ibm.com">manager04@ibm.com</option>
								</select>
							</div>
						</div>
						<div class="row mt-2"></div>		
						
						<div class="form-group row">
							<label for="professional-dropdown" class="col-sm-3 col-form-label"><b>Professional</b></label>
							<div class="col-sm-9" id="id-professional">
								<select id="professional-dropdown" name="professional"
											onchange="professionalUpdated()" class="form-select"></select>
							</div>
						</div>
						
						<div class="row mt-2"></div>				
						<div class="form-group row">
							<label for="horizontalRule" class="col-sm-12 col-form-label"><hr/></label>
						</div>		

						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="growth-platform" class="col-sm-3 col-form-label">
								<b>Growth Platform</b>
							</label>
							<div class="col-sm-9" id="id-growth-platform">
							</div>
						</div>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="service-line" class="col-sm-3 col-form-label"><b>Service Line</b></label>
							<div class="col-sm-9" id="id-service-line">
							</div>
						</div>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="practice" class="col-sm-3 col-form-label"><b>Practice</b></label>
							<div class="col-sm-9" id="id-practice">
							</div>
						</div>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="service-area-text" class="col-sm-3 col-form-label"><b>Service Area</b></label>
							<div class="col-sm-9" id="id-service-area">
							</div>
						</div>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="job-role-text" class="col-sm-3 col-form-label"><b>Job Role</b></label>
							<div class="col-sm-9" id="id-job-role">
							</div>
						</div>
						<div class="form-group row">
							<div id="job-role-table"></div>
						</div>
						<div class="row mt-2"></div>
						<div class="form-group row">
							<label for="specialty-text" class="col-sm-3 col-form-label"><b>Specialty</b></label>
							<div class="col-sm-9" id="id-specialty">
							</div>
						</div>
						<div class="form-group row">
							<div id="specialty-table"></div>
						</div>
						<div class="form-group row">
							<div class="col-sm-12">
								<div id="msg-line" class="alert alert-danger alert-dismissible fade">
									<div id="msg"></div>
									<button type="button" class="close" data-dismiss="alert" onclick="hideMsg()">&times;</button>
								</div>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-sm-12">
								<button type="button" id="id-btn-save" class="btn btn-primary" onclick="javascipt:doSave()" disabled>Save</button>
								<button type="button" class="btn btn-secondary" onclick="javascipt:doCancel()">Cancel</button>
								<button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#id-info-modal" data-bs-content="data-integrity-framework-jrs-validator">Help</button>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-sm-12">
								<p>&nbsp;</p>
							</div>
						</div>
					</form>
				</div>
			</div>


          </div>

          <div class="col-lg-4">
            <div class="portfolio-info">
            	<h5>Branches</h5>
				<nav>
					<div class="nav nav-tabs" id="nav-tab" role="tablist">
						<button class="nav-link" id="nav-current-tab" data-bs-toggle="tab" data-bs-target="#nav-current" type="button" role="tab" aria-controls="nav-current" aria-selected="true">Current</button>
						<button class="nav-link active" id="nav-leaf-tab" data-bs-toggle="tab" data-bs-target="#nav-leaf" type="button" role="tab" aria-controls="nav-leaf" aria-selected="false">JR/S</button>
						<button class="nav-link" id="nav-rec-tab" data-bs-toggle="tab" data-bs-target="#nav-rec" type="button" role="tab" aria-controls="nav-rec" aria-selected="true">Recommended</button>
					</div>
				</nav>
				<div class="tab-content" id="nav-tabContent">
					<div class="tab-pane fade" id="nav-current" role="tabpanel" aria-labelledby="nav-current-tab">
					</div>
					<div class="tab-pane fade show active" id="nav-leaf" role="tabpanel" aria-labelledby="nav-leaf-tab">
					</div>
					<div class="tab-pane fade" id="nav-rec" role="tabpanel" aria-labelledby="nav-leaf-rec">
						<p>&nbsp;</p>
						<p>Coming soon.</p>
						<div>
							<button type="button" class="btn btn-primary btn-sm" onclick="javascript:acceptRecommendation()">
								Accept recommendation
							</button>
						</div>
					</div>
				</div>
            </div>
            <div class="portfolio-description">
				<h2>Full JR/S taxonomy interactive viewer/search</h2>
				<div>
					<p>The full job role specialty taxonomy interactive viewer/search loads the complete JR/S taxonomy and allows the user to navigate and search the taxonomy.</p>
					<!-- Button trigger modal 
					<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#jrsViewerModal">
						Launch viewer...
					</button>
					-->
					<a href="try-it-jrs-collapsible-tree-search.html" target="_blank"><button type="button" class="btn btn-primary">
						Launch JR/S view/search...
					</button>
				</div>

            </div>
          </div>

        </div>
        
		<div class="row gy-12">
      		<p>&nbsp;</p>
      		<hr/>
		</div>

        <div class="row gy-12">
      		<div class="panel panel-primary" id="api_panel">
				<div class="panel-heading">
					<h3 class="panel-title">API Execution List</h3>
				</div>
				<div class="panel-body">
					<ul class="list-group" id="id_api_list">

					</ul>
				</div>
			</div>
		</div>
      
      </div>
    </section>
	<!-- End Portfolio Details Section -->

  </main>
<!-- End #main -->

	<!-- ======= Footer ======= -->
	<footer id="footer" class="footer">


		<div class="footer-top">
			<div class="container">
				<div class="row gy-4">
					<div class="col-lg-5 col-md-12 footer-info">
						<a href="index.html" class="logo d-flex align-items-center"> <img src="assets/img/logo.png" alt=""> <span>WFM</span>
						</a>
						<p>Empower profitable growth through cognitive workforce management capabilities to anticipate client needs,
							delivering the right skills at the right time yielding business outcomes that matter to our clients, our
							employees, and our company.</p>
						<div class="social-links mt-3">
							<a href="#" class="linkedin"><i class="bi bi-linkedin bx bxl-linkedin"></i></a> <a href="#" class="twitter"><i
								class="bi bi-twitter"></i></a> <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
						</div>
					</div>

					<div class="col-lg-2 col-6 footer-links">
						<h4>Useful Links</h4>
						<ul>
							<li><i class="bi bi-chevron-right"></i> <a
								href="https://w3.ibm.com/w3publisher/ibm-services-workforce-management">WFM Home</a></li>
							<li><i class="bi bi-chevron-right"></i> <a href="index.html#about">About us</a></li>
							<li><i class="bi bi-chevron-right"></i> <a href="index.html#services">Services</a></li>
							<li><i class="bi bi-chevron-right"></i> <a href="https://w3.ibm.com">Terms of service</a></li>
							<li><i class="bi bi-chevron-right"></i> <a href="https://w3.ibm.com/w3publisher/w3-privacy-notice/ibm-internal-privacy-statement-us-en">Privacy
									policy</a></li>
						</ul>
					</div>

					<div class="col-lg-2 col-6 footer-links">
						<h4>Our Services</h4>
						<ul>
							<li><i class="bi bi-chevron-right"></i> <a href="#">tbd</a></li>

						</ul>
					</div>

					<div class="col-lg-3 col-md-12 footer-contact text-center text-md-start">
						<h4>Contact Us</h4>
						<p>
							<b>Steven J Ponessa</b> <br> Mount Pleasant, SC, United States <br> <strong>Phone:</strong> +1
							845-699-5617 <br> <strong>Email:</strong> <a href="mailto:ponessa@us.ibm.com">ponessa@us.ibm.com</a>
						</p>
						<p>
							<b>Mani Shahidsales</b> <br> Blue Bell, PA, United States <br> <strong>Phone:</strong> +1 845-699-5617
							<br> <strong>Email:</strong> <a href="mailto:mshahids@us.ibm.com">mshahids@us.ibm.com</a>
						</p>

					</div>

				</div>
			</div>
		</div>

		<div class="container">
			<div class="copyright">
				&copy; Copyright <strong><span>IBM</span></strong>. All Rights Reserved
			</div>
			<div class="credits">
				<!-- All the links in the footer should remain intact. -->
				<!-- You can delete the links only if you purchased the pro version. -->
				<!-- Licensing information: https://bootstrapmade.com/license/ -->
				<!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/flexstart-bootstrap-startup-template/ -->
				Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
			</div>
		</div>
	</footer>
	<!-- End Footer -->


  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="assets/js/jsonview.bundle.js"></script>
  
  <script type="text/javascript">
  $("#jrsViewerModal").draggable({
      handle: ".modal-header"
  });
  </script>

</body>
</html>